<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Psych</title>
  <meta name="description" content="An introduction to data management and analysis for psychological research using R.">
  <meta name="generator" content="bookdown 0.6 and GitBook 2.6.7">

  <meta property="og:title" content="R for Psych" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://glennwilliams.me/r4psych/" />
  
  <meta property="og:description" content="An introduction to data management and analysis for psychological research using R." />
  <meta name="github-repo" content="gpwilliams/r4psych" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Psych" />
  
  <meta name="twitter:description" content="An introduction to data management and analysis for psychological research using R." />
  

<meta name="author" content="Glenn Williams">


<meta name="date" content="2018-02-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-visualisation-1.html">
<link rel="next" href="data-manipulation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Psych</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface &amp; Overview</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#installation-and-setup"><i class="fa fa-check"></i><b>1.1</b> Installation and Setup</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#working-directory-and-file-paths"><i class="fa fa-check"></i><b>1.2</b> Working Directory and File Paths</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.3</b> Packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#objects-and-functions"><i class="fa fa-check"></i><b>1.4</b> Objects and Functions</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#creating-and-accessing-data"><i class="fa fa-check"></i><b>1.5</b> Creating and Accessing Data</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#good-practice"><i class="fa fa-check"></i><b>1.6</b> Good Practice</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#data-checking-tips"><i class="fa fa-check"></i><b>1.6.1</b> Data Checking Tips</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction.html"><a href="introduction.html#style"><i class="fa fa-check"></i><b>1.6.2</b> Style</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html"><i class="fa fa-check"></i><b>2</b> Data Visualisation 1</a><ul>
<li class="chapter" data-level="2.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#the-star-wars-tibble"><i class="fa fa-check"></i><b>2.1.1</b> The Star Wars Tibble</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>2.1.2</b> Plotting in ggplot2</a></li>
<li class="chapter" data-level="2.1.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#cleaning-before-plotting"><i class="fa fa-check"></i><b>2.1.3</b> Cleaning Before Plotting</a></li>
<li class="chapter" data-level="2.1.4" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#changing-your-aesthetics"><i class="fa fa-check"></i><b>2.1.4</b> Changing Your Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#exploring-different-geoms"><i class="fa fa-check"></i><b>2.2</b> Exploring Different Geoms</a><ul>
<li class="chapter" data-level="2.2.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#bar-plots"><i class="fa fa-check"></i><b>2.2.1</b> Bar Plots</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#box-plots"><i class="fa fa-check"></i><b>2.2.2</b> Box Plots</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#violin-plots"><i class="fa fa-check"></i><b>2.2.3</b> Violin Plots</a></li>
<li class="chapter" data-level="2.2.4" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#density-plots"><i class="fa fa-check"></i><b>2.2.4</b> Density Plots</a></li>
<li class="chapter" data-level="2.2.5" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#histograms"><i class="fa fa-check"></i><b>2.2.5</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#exercises-1"><i class="fa fa-check"></i><b>2.3</b> Exercises</a><ul>
<li class="chapter" data-level="2.3.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#main-exercises"><i class="fa fa-check"></i><b>2.3.1</b> Main Exercises</a></li>
<li class="chapter" data-level="2.3.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#additional-exercise"><i class="fa fa-check"></i><b>2.3.2</b> Additional Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html"><i class="fa fa-check"></i><b>3</b> Data Visualisation 2</a><ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#customising-your-plots"><i class="fa fa-check"></i><b>3.1</b> Customising Your Plots</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#pirate-plots"><i class="fa fa-check"></i><b>3.2</b> Pirate Plots</a></li>
<li class="chapter" data-level="3.3" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#faceting"><i class="fa fa-check"></i><b>3.3</b> Faceting</a><ul>
<li class="chapter" data-level="3.3.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#facet-wrap"><i class="fa fa-check"></i><b>3.3.1</b> Facet Wrap</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#facet-grid"><i class="fa fa-check"></i><b>3.3.2</b> Facet Grid</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#calculating-statisitcs-in-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Calculating Statisitcs in ggplot2</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#means-and-error-bars"><i class="fa fa-check"></i><b>3.4.1</b> Means and Error Bars</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#model-fits"><i class="fa fa-check"></i><b>3.4.2</b> Model Fits</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#combining-plots"><i class="fa fa-check"></i><b>3.5</b> Combining Plots</a></li>
<li class="chapter" data-level="3.6" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#saving-plots"><i class="fa fa-check"></i><b>3.6</b> Saving Plots</a></li>
<li class="chapter" data-level="3.7" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation</a></li>
<li class="chapter" data-level="5" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>5</b> Summarising Data</a></li>
<li class="chapter" data-level="6" data-path="traditional-tests.html"><a href="traditional-tests.html"><i class="fa fa-check"></i><b>6</b> Traditional Tests</a></li>
<li class="chapter" data-level="7" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html"><i class="fa fa-check"></i><b>7</b> Simulation and Calculating Power</a></li>
<li class="chapter" data-level="8" data-path="mixed-effects-models-1.html"><a href="mixed-effects-models-1.html"><i class="fa fa-check"></i><b>8</b> Mixed Effects Models 1</a></li>
<li class="chapter" data-level="9" data-path="mixed-effects-models-2.html"><a href="mixed-effects-models-2.html"><i class="fa fa-check"></i><b>9</b> Mixed Effects Models 2</a></li>
<li class="chapter" data-level="10" data-path="creating-reproducible-documents.html"><a href="creating-reproducible-documents.html"><i class="fa fa-check"></i><b>10</b> Creating Reproducible Documents</a><ul>
<li class="chapter" data-level="10.1" data-path="creating-reproducible-documents.html"><a href="creating-reproducible-documents.html#the-final-lesson"><i class="fa fa-check"></i><b>10.1</b> The Final Lesson</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Psych</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualisation-2" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data Visualisation 2</h1>
<p>In this section we’ll cover more advanced plotting methods in ggplot2. We’ll look at customising plots, making <strong>pirate plots</strong>, installing packages from GitHub, faceting, and stitching plots together.</p>
<p>To get started, as always we’ll load our packages and saved data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rt_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;inputs/rt_data.csv&quot;</span>)</code></pre></div>
<div id="customising-your-plots" class="section level2">
<h2><span class="header-section-number">3.1</span> Customising Your Plots</h2>
<p>Take the desnity plot below, this is functional, but it’s pretty ugly. We’ll look at ways to change the looks of a plot aside from simply changing your mapped aesthetics from the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> reaction_time, 
                                     <span class="dt">fill =</span> response_condition)
       ) +
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Reaction Time (ms)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">600</span>), 
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">200</span>, <span class="dt">to =</span> <span class="dv">600</span>, <span class="dt">by =</span> <span class="dv">100</span>)
                     ) +
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Response Condition&quot;</span>)) +
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_density_plot-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> reaction_time)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">50</span>, 
                 <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, 
                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>
                 ) +
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">600</span>),
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">200</span>, <span class="dt">to =</span> <span class="dv">600</span>, <span class="dt">by =</span> <span class="dv">25</span>)
                     ) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Reaction Time (ms)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>)</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_histogram_plot-1.png" width="672" /></p>
</div>
<div id="pirate-plots" class="section level2">
<h2><span class="header-section-number">3.2</span> Pirate Plots</h2>
<p>Now, pirate plots are a great choice of plot for the indecisive. Pirate plots are essentially the individual points of data, a bar plot, a violin plot, and a confidence interval interval all in one. This way, you get to see the raw, descriptive, and inferential data on one plot!</p>
<p>This is a nice way to show data that are grouped by categories but with a continuous dependent variable.</p>
<p>We could make these ourselves by doing some calculations and combining <code>geoms</code> in ggplot2. Or, we could just install a package from <a href="https://github.com/mikabr/ggpirate">Github</a> which will do that for us. First, we’ll have to install <code>devtools</code> in R which will allow us to install packages from Github. (For packages on CRAN, this isn’t necessary, but unfortunately ggpirate isn’t on CRAN at the time of writing.)</p>
<p>To install <code>devtools</code> and the <code>ggpirate</code> package, uncomment and run the code below. Then as always, use <code>library(ggpirate)</code> to load the package.</p>
<p>Below, we’ll make a pirate plot. Note that you only need the first two calls (lines 1-6) to create the plot: The first to set up how you’re going to map your data (and the source of your data), and the second to add the <code>geom</code> for the pirate plot itself. We added the aethetics of colour and fill to match our conditions within this call, so the two levels of <code>response_condition</code> have different colours.</p>
<p>For the additional lines:</p>
<ul>
<li><code>labs</code> allows you to manually change the x and y axis labels</li>
<li><code>scale_x_discrete</code> allows you to manipulate your x scale. Within this, we change the labels of the columns using <code>labels</code>. We changed them to Impaired (vs. impaired) and Intact (vs. intact) for stylisitc reasons.</li>
<li><code>scale_y_continuous</code> allows you to manipulate your y scale. Here, we set the <code>limits</code>, i.e. how far to extend our y-axis to between 0 and 600ms. Additionally, we set our <code>breaks</code> to increment in the sequence (<code>seq</code>) from 0 to 600 by 100ms. This way, we’ve added more granularity to our axis ticks.</li>
<li>We use <code>theme_bw()</code> to change to a black and white theme. There are other themes in <code>ggplot2</code>, but this one is nice and clean.</li>
<li>Finally, <code>theme</code> allows you to manually specify other aspects of how your plot should look. Here, we used <code>panel.grid.major.x</code> and set this to nothing (<code>element_blank()</code>) because we don’t need vertical lines in our plot.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> response_condition, 
                                     <span class="dt">y =</span> reaction_time)
       ) +
<span class="st">  </span><span class="kw">geom_pirate</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> response_condition, 
                  <span class="dt">fill =</span> response_condition)
              ) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Motor Skill&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Reaction Time (ms)&quot;</span>) +
<span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Impaired&quot;</span>, <span class="st">&quot;Intact&quot;</span>)) +
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">600</span>), 
                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">600</span>, <span class="dt">by =</span> <span class="dv">100</span>)
                     ) +
<span class="st">  </span><span class="kw">theme_bw</span>() +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_pirate_plot-1.png" width="672" /></p>
<p>In this plot, we have coloured bars and lines indicating the mean scores, a box representing the 95% confidence interval assuming a normal sampling distribution, violins indicating density, and the raw data points.</p>
<p>If the 95% confidence interval between the two groups doesn’t overlap, we can be fairly sure there is a significant difference between the groups. So, here we can be fairly certain the two groups differ in reaction times.</p>
</div>
<div id="faceting" class="section level2">
<h2><span class="header-section-number">3.3</span> Faceting</h2>
<p>Another useful part of plotting in <code>ggplot2</code> is that you can make facets of plots, or subplots. This is a good way to display your data if you have multiple categorical variables. Essentially, you’ll get a plot for each category in your data.</p>
<div id="facet-wrap" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Facet Wrap</h3>
<p>If you want to create facets from one variable then use <code>facet_wrap()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> reaction_time)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">50</span>, 
                 <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, 
                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>
                 ) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>response_condition)</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_facet_wrap-1.png" width="672" /></p>
<p>In this plot, we’ve specified a histogram as we normally would. However, we use <code>facet_wrap()</code> and a tilde (<code>~</code>) to create a formula for how to display our plots. We define our variable with which to split our plots to the right of the <code>~</code>, and <code>ggplot</code> automatically plots the two separately at the same time. Notice that we get useful labels at the top of these plots, too.</p>
</div>
<div id="facet-grid" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Facet Grid</h3>
<p>If we wanted to make a facet by two variables, then we would use <code>facet_grid()</code> instead. In this case, we just add each variable to either side of the <code>~</code> and <code>ggplot</code> will do the splitting for us.</p>
<p>Let’s see how this works if we split our data by gender and response condition.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> reaction_time)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">50</span>, 
                 <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, 
                 <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>
                 ) +
<span class="st">  </span><span class="kw">facet_grid</span>(gender ~<span class="st"> </span>response_condition)</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_facet_grid-1.png" width="672" /></p>
<p>The order in which you specify the two variables matters. Try swapping around between <code>facet_wrap(gender ~ response_condition)</code> and <code>facet_wrap(response_condition ~ gender)</code> to see how this works.</p>
</div>
</div>
<div id="calculating-statisitcs-in-ggplot2" class="section level2">
<h2><span class="header-section-number">3.4</span> Calculating Statisitcs in ggplot2</h2>
<p>Sometimes, plotting just the means isn’t enough. We saw how useful the 95% confidence interval from <code>ggpirate</code> is for making inferences about the differences between groups. Nicely, we can get standard errors or confidence intervals around our data points within <code>ggplot</code> for other geoms.</p>
<div id="means-and-error-bars" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Means and Error Bars</h3>
<p>Let’s say you wanted a bar plot with error bars showing the standard error. You can create this in <code>ggplot</code> using the <code>stat_summary</code> function. In the first instance here, we tell it that we want to run the function <code>mean</code> over our data that make up the y-axis; hence <code>fun.y = mean</code>. We also need to specify which geom we want to return from this.</p>
<p>Try changing the geom to <code>point</code> in the first <code>stat_summary</code> call to see what happens when you run this plot with <code>geom = &quot;point&quot;</code>.</p>
<p>Finally, we ask for another summary, but this time we want an error bar. So, for the geom call we request an error bar. Crucially, the function we require to get this errorbar is <code>fun.data = &quot;mean_se&quot;</code>. That’s because we need the mean to know where the centre the errorbar, and the standard error to get the limits of the bar. We manually changed the width of the bar to a quarter of the bar size using the <code>width</code> argument to stop <code>ggplot</code> returning super wide error bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rt_data, 
       <span class="dt">mapping =</span> <span class="kw">aes</span>(
         <span class="dt">x =</span> response_condition,
         <span class="dt">y =</span> reaction_time, 
         <span class="dt">fill =</span> response_condition
         )
       ) +<span class="st"> </span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>) +
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_se&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="dt">width =</span> <span class="fl">0.25</span>)</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_error_bars-1.png" width="672" /></p>
<p>I don’t often use <code>stat_summary</code> in my own plots, as I often want to know exactly how I’ve calculated things like the standard error. Doing things by hand allows you to change error bar sizes appropriately for within- and between-subject designs. But, this is useful if you want to create a plot rapidly, or want to avoid the hassle of writing extra code.</p>
</div>
<div id="model-fits" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Model Fits</h3>
<p>Here’ we’ll switch again to a different data set that has two continuous variables. The <code>starwars</code> data set is useful for this exercise.</p>
<p>We can use the <code>geom_smooth()</code> function to fit a model to our data. This defaults to a loess method, but we can change this to a linear model (or other alternatives) as in the second plot below. By default, these smoothed plots display a ribbon around the fit which indicates the confidence interval (95% by default).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># remove NA and mass above 1000</span>
filtered_starwars &lt;-<span class="st"> </span>starwars %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">drop_na</span>(height, mass) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(mass &lt;<span class="st"> </span><span class="dv">1000</span>)

<span class="co"># plot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> filtered_starwars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mass, <span class="dt">y =</span> height)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>()</code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="R_for_Psych_files/figure-html/3_smooth_starwars-1.png" width="672" /></p>
<p>Next, we’ll change the defaults in order to fit a linear model. We do this in the <code>geom_smooth</code> function, <code>method = &quot;lm&quot;</code>. We can additionally specify a function, so we can change how we fit the data. Currently, our formula is <code>y ~ x</code>, which is a regular linear model. We could, however, fit a quadratic function to the data by using <code>y ~ poly(x, 2)</code>. The function <code>poly(x, 2)</code> calculates orthogonal polynomials to a certain degree. The first being linear, second quadratic (think curved lines with 1 inflection point), the third cubic (think curved lines with 2 inflection points), etc.. For now, we’ll just fit the linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> filtered_starwars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mass, <span class="dt">y =</span> height)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">formula =</span> y ~<span class="st"> </span>x)</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_linear_starwars-1.png" width="672" /></p>
<p>Alternatively, if we have a fitted model saved from our analyses, we can add the fitted line directly using the <code>stat_summary</code> function. However, this requires some insight into the models fitted, so we’ll save this for later classes.</p>
</div>
</div>
<div id="combining-plots" class="section level2">
<h2><span class="header-section-number">3.5</span> Combining Plots</h2>
<p>Finally, while it’s all well and good plotting one model at a time, often if you’re writing a paper you want several plots together to save space. You could do this by hand in certain image editing packages, but luckily there’s a package for this on CRAN; <code>cowplot</code>. First, we need to install and load the package. Intall this by running the commented out code below. After that, load <code>cowplot</code> each time you want to use it.</p>
<p>So far, we’ve just been running the code to produce plots, but we haven’t saved them in our environment. But, in order to stich two plots together, we need to save our plots as objects so they’re available to the R environment.</p>
<p>If we assign our plotting code to an object, then every time we run the name of the object, we’ll get the output of that code back.</p>
<p>For keeping several plots in my environemnt at once, I often save them to an object. In this instance, we’ll save a plot of just the points to the name <code>point_plot</code>. That’s because we want to overlay a linear fit and a quadratic fit on this plot separately, but we don’t want to type the full code out twice. Instead, we fit the plot of points to <code>point_plot</code>, then add a linear or quadratic fit by adding the <code>geom_smooth</code> argument to <code>point_plot</code> and saving both under new names. We can do this like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a plot of points</span>
point_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> filtered_starwars, 
                     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mass, <span class="dt">y =</span> height)
                     ) +
<span class="st">  </span><span class="kw">geom_point</span>()

<span class="co"># create a linear plot by adding the fit to the plot of points</span>
linear_plot &lt;-<span class="st">  </span>point_plot +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">formula =</span> y ~<span class="st"> </span>x)</code></pre></div>
<p>When you do this, you won’t automatically see the plot once you run the code unless you run the object assigned to the plot. Let’s try this for a quadratic fit of the same data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a quadratic plot by adding the fit to the plot of points</span>
quadratic_plot &lt;-<span class="st"> </span>point_plot +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">formula =</span> y ~<span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>)) <span class="co"># fit quadratic</span>

<span class="co"># return the plot</span>
quadratic_plot</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_save_quadratic_plot-1.png" width="672" /></p>
<p>You can see that we’ve got the quadratic fit and the 95% confidence interval around this fit from the above code. Why does the plot look different to the base plots in ggplot2? <code>cowplot</code> loads some defaults for all plots outputted by <code>ggplot</code> to save you on typing out your own theme arguments.</p>
<p>Now, we can combine these two plots into a single plot using the new functionalities from <code>cowplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">combined_plots &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(linear_plot, 
                            quadratic_plot, 
                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="co"># label plots</span>
                            <span class="dt">align =</span> <span class="st">&quot;h&quot;</span> <span class="co"># align axes</span>
                            ) 
combined_plots</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_combine_plots-1.png" width="672" /></p>
<p>What if we want a title for our plots? We first have to define our title with a combination of <code>ggdraw()</code> and <code>draw_label()</code>. Inside <code>draw_label()</code> we used a new function, <code>paste()</code> to paste two strings of text together (with a space between the two strings). We could simply input the entire string, but we broke it down into two bits so we don’t exceed the 80 character width limit from our style guide!</p>
<p>We further specify a bold <code>fontface</code> in the <code>draw_label()</code> command outside our pasted title.</p>
<p>Finally, we display the plot by creating a <code>plot_grid()</code> of our plot and the title in this order so the title displays underneath the plot. We specify that we just want 1 column so the plot and title are stacked together, and we specify the relative heights of the title and plot separately so that the title is smaller than the plot so it doesn’t take up an equal amount of space as the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create title</span>
title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">draw_label</span>(<span class="kw">paste</span>(<span class="st">&quot;Linear (A) and Quadratic&quot;</span>,
                   <span class="st">&quot;(B) fits of Height and Weight&quot;</span>
                   ), 
             <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>
             )

<span class="co"># print plot as a grid</span>
combined_plots &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(combined_plots, 
                            title, 
                            <span class="dt">ncol =</span> <span class="dv">1</span>, 
                            <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)
                            )
combined_plots</code></pre></div>
<p><img src="R_for_Psych_files/figure-html/3_add_plot_title-1.png" width="672" /></p>
<p>You can find further information on adding joint titles, annotations, etc. in <a href="https://htmlpreview.github.io/?https://github.com/wilkelab/cowplot/blob/master/inst/doc/plot_annotations.html">this article</a> by Claus O. Wilke.</p>
</div>
<div id="saving-plots" class="section level2">
<h2><span class="header-section-number">3.6</span> Saving Plots</h2>
<p>Finally, if you’ve went to the work of producing a nice plot, then it’ll be useful to know how to save it somewhere. To save our combined plot of the linear and quadratic fits, we’ll use <code>ggsave</code>. You can name your plot anything you like, but remember to add a file extension at the end. I’ve used .png as this format suffers from fewer artifacts when comapred to JPEG, and it’s a pretty common filetype.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;outputs/starwars_mass_by_height.png&quot;</span>, 
       <span class="dt">plot =</span> combined_plots
       )</code></pre></div>
<p>You can do a whole bunch of other things with <code>ggplot</code>, like adding vertical and horizontal lines (often useful for identifying chance performance in participants), and annotating plots directly (useful for adding statistics, or commenting on interesting sections of the data). We’ll cover these in the exercises, however, as these are just additional flavour to our plots!</p>
</div>
<div id="exercises-2" class="section level2">
<h2><span class="header-section-number">3.7</span> Exercises</h2>
<p>Try out the exercises below, we’ll cover these in the class with the solutions uploaded at the beginning of each session in a separate downloadable link. Try to solve these questions before resorting to the solutions. I’ll be there to help out where necessary.</p>
<ol style="list-style-type: decimal">
<li></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualisation-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-manipulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
